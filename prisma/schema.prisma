generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
}




enum Tag {
  STYLE
  CULTURE
  BUSINESS_AND_MONEY
}
enum SubTags {
  FASHION
  WATCHES_AND_ACCESSORIES
  GROOMING_AND_WELLNESS
  ENTERTAINMENT
  PEOPLE_AND_PROFILES
  LEADERSHIP_AND_ENTREPRENEURSHIP
  WEALTH
  WORK_AND_CAREERS
}



enum Role {
  USER
  ADMIN
}

model User {
  id            String    @id @default(cuid())
  email         String    @unique
  name          String?
  password      String
  role          Role      @default(USER)
  subscriptionPlan SubscriptionPlan @default(FREE)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  savedArticles Article[] @relation("SavedArticles")
  savedProducts Product[] @relation("SavedProducts")
  readList      Issues[]  @relation("SavedIssues")
  sessions      Session[]
  addresses     Address[]
  cart          Cart?
  orders        Order[]
  newsletterSubscription NewsletterSubscriber?
}

model NewsletterSubscriber {
  id           String   @id @default(cuid())
  email        String   @unique
  isSubscribed Boolean  @default(true)
  userId       String?  @unique
  user         User?    @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Article {
  id              String       @id @default(cuid())
  title           String
  slug            String       @unique
  body            String
  bannerImage     String?
  featured        Boolean      @default(true)
  isPremium       Boolean      @default(false)
  writtenBy       String
  publicationDate DateTime     @default(now())
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt
  category        Tag
  subcategory     SubTags
  savedBy         User[]  @relation("SavedArticles")
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Category {
  id          String    @id @default(cuid())
  name        String    @unique
  description String?
  products    Product[] @relation("ProductCategory")
}

enum ProductType {
  BAGS
  BELTS
  BLAZERS
  CAPS
  JEANS
  JOGGERS
  PERFUMES
  SUNGLASSES
  FRAMES
  SHIRTS
  POLOS
  SHOES
  SHORTS
  SWEATERS
  TSHIRTS
  WALLETS
  OTHER
}

model Product {
  id              String      @id @default(cuid())
  name            String
  price           Float
  desc            String?
  size            String?
  designer        String?
  color           String?
  itemType        ProductType?
  stock           Int         @default(0)
  image           String
  categories      Category[]  @relation("ProductCategory")
  cartItems       CartItem[]
  orderItems      OrderItem[]
  savedBy         User[]      @relation("SavedProducts")
  isAffiliate     Boolean     @default(false)
  affiliateLink   String?
  affiliateVendor String?
}

model Issues {
  id        String     @id @default(cuid())
  title     String 
  releaseDate DateTime
  coverImage String?
  description String?
  teaserText  String?
  viewLink  String
  buyLink String?
  savedBy  User[] @relation("SavedIssues")
  createdAt   DateTime @default(now())
  updatedAt       DateTime     @updatedAt
}

enum SubscriptionPlan {
  FREE
  PREMIUM
  VIP
}

model Sponsored {
  id          String   @id @default(cuid())
  title       String
  description String
  slug        String   @unique
  client      String
  image       String?
  link        String?
  type        SponsoredType @default(PERSON)
  active      Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

enum SponsoredType {
  PERSON
  ITEM
  EVENT
}

enum EventType {
  FREE
  PAID
  INVITE_ONLY
}

model Interview {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  excerpt     String?
  content     String
  videoUrl    String?
  coverImage  String?
  featured    Boolean  @default(false)
  tagline     String?
  people      String?  // Name of the person interviewed
  publishedAt DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Event {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  description String
  date        DateTime
  location    String?
  imageUrl    String?
  ticketLink  String?
  type        EventType @default(FREE)
  price       Float?
  featured    Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Cart {
  id        String     @id @default(cuid())
  userId    String     @unique
  user      User       @relation(fields: [userId], references: [id], onDelete: Cascade)
  items     CartItem[]
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

model CartItem {
  id        String  @id @default(cuid())
  quantity  Int     @default(1)
  cartId    String
  productId String
  cart      Cart    @relation(fields: [cartId], references: [id], onDelete: Cascade)
  product   Product @relation(fields: [productId], references: [id], onDelete: Restrict)

  @@index([cartId])
  @@index([productId])
}

model Address {
  id               String  @id @default(cuid())
  street           String
  city             String
  state            String
  zipCode          String
  country          String
  isShipping       Boolean @default(false)
  isBilling        Boolean @default(false)
  userId           String
  user             User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  shippingForOrder Order[] @relation("ShippingAddress")
  billingForOrder  Order[] @relation("BillingAddress")

  @@index([userId])
}

enum OrderStatus {
  PAID
  PENDING
  SHIPPED
  DELIVERED
  CANCELED
}

model Order {
  id                String      @id @default(cuid())
  orderId           String      @unique @default(cuid())
  userId            String
  reference         String?     @unique
  user              User        @relation(fields: [userId], references: [id], onDelete: Cascade)
  items             OrderItem[]
  status            OrderStatus @default(PENDING)
  subTotal          Float
  total             Float
  paid              Boolean     @default(false)
  shippingAddressId String
  billingAddressId  String
  shippingAddress   Address     @relation("ShippingAddress", fields: [shippingAddressId], references: [id], onDelete: NoAction)
  billingAddress    Address     @relation("BillingAddress", fields: [billingAddressId], references: [id], onDelete: NoAction)
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  discountId        String?
  discount          Discount?   @relation(fields: [discountId], references: [id])

  @@index([userId])
}

model OrderItem {
  id              String  @id @default(cuid())
  quantity        Int
  priceAtPurchase Float
  orderId         String
  productId       String
  order           Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product         Product @relation(fields: [productId], references: [id], onDelete: NoAction)

  @@index([orderId])
  @@index([productId])
}

enum DiscountType {
  PERCENTAGE
  FIXED_AMOUNT
}

model Discount {
  id           String       @id @default(cuid())
  code         String       @unique
  description  String?
  discountType DiscountType
  value        Float
  validTill    DateTime
  isActive     Boolean      @default(true)
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  orders       Order[]
}


model Ad {
  id        String   @id @default(cuid())
  title     String
  image     String
  link      String
  type      Tag[]
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
